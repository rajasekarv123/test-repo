{"jsonrpc":"2.0","id":0,"result":{"qScript":"///$tab Main\r\nSET ThousandSep=',';\r\nSET DecimalSep='.';\r\nSET MoneyThousandSep=',';\r\nSET MoneyDecimalSep='.';\r\nSET MoneyFormat='$#,##0.00;($#,##0.00)';\r\nSET TimeFormat='h:mm:ss TT';\r\nSET DateFormat='M/D/YYYY';\r\nSET TimestampFormat='M/D/YYYY h:mm:ss[.fff] TT';\r\nSET MonthNames='Jan;Feb;Mar;Apr;May;Jun;Jul;Aug;Sep;Oct;Nov;Dec';\r\nSET DayNames='Mon;Tue;Wed;Thu;Fri;Sat;Sun';\r\n\r\nLOAD\r\n    Name as State,\r\n    Area\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/USStatesPoly.xlsx]\r\n(ooxml, embedded labels, table is Sheet1);\r\n\r\n TAG FIELDS \"Area\" WITH $geopolygon;\r\n\r\nLOAD\r\n    Metric\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Metrics.xlsx]\r\n(ooxml, embedded labels, table is Sheet1);\r\n\r\nTest:\r\nLoad * inline [\r\nField, Data\r\nName, Ashoke\r\nCIS Number, 5678255\r\nAddress, hgste\r\nNationality, Inida\r\n];\r\n\r\n\r\n[Item Map]:\r\nMapping \r\nLOAD\r\n    \"Item Number\",\r\n    \"Line1 Desc\"\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Consumer Goods Items.xlsx]\r\n(ooxml, embedded labels, table is Sheet1);\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n///$tab Section\r\nLOAD\r\n    BasketItem,\r\n    \"Basket Produce Line\",\r\n    \"Basket Product Group Desc\",\r\n    \"Basket Product Line Desc\",\r\n    \"Basket Product Sub Group Desc\",\r\n    \"Basket Product Type Desc\",\r\n    \"Basket Item Desc\"\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataBasket.QVD]\r\n(qvd);\r\n\r\nLOAD\r\n    DummyField,\r\n    BudgetInput2,\r\n    BudgetYear,\r\n    BudgetPeriod,\r\n    Type,\r\n    \"Budget Amount\",\r\n    \"Actual Amount\",\r\n    BudKey,\r\n    BudgetInput\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataBudget3.QVD]\r\n(qvd);\r\n\r\nLOAD\r\n    BudgetPeriod,\r\n    textBudgetPeriod\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataBudgetPeriod.QVD]\r\n(qvd);\r\n\r\nLOAD\r\n    CustKey,\r\n    Cust_Increasing,\r\n    Cust_Decreasing,\r\n    Cust_Steady,\r\n    Cust_New,\r\n    Cust_Lost,\r\n    Cust_Other,\r\n    \"Customer Growth\",\r\n    \"Customer Growth Percent\"\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataCustomerClassification.QVD]\r\n(qvd);\r\n\r\n\r\n\r\n\r\n\r\n\r\n///$tab Section 2\r\nLOAD\r\n    State,\r\n    \"Customer X\",\r\n    \"Customer Y\"\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataCustomerMapCoordinates.QVD]\r\n(qvd);\r\n\r\nLOAD\r\n    DateKey,\r\n    \"Day\",\r\n    \"Month\",\r\n    Quarter,\r\n    \"Week\",\r\n    \"Week Ending Date\",\r\n    \"Weekday\",\r\n    \"Year\",\r\n    YearMonth\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataDates2.QVD]\r\n(qvd);\r\n\r\nLOAD\r\n    AggKey,\r\n    \"YTD Sales Amount\",\r\n    \"LY YTD Sales Amount\",\r\n    \"TM Sales Amount\",\r\n    \"LY TM Sales Amount\",\r\n    \"LY Tot Sales Amount\",\r\n    \"YTD Sales Margin Amount\",\r\n    \"LY YTD Sales Margin Amount\",\r\n    \"TM Sales Margin Amount\",\r\n    \"LY TM Sales Margin Amount\",\r\n    \"LY Tot Sales Margin Amount\",\r\n    \"Current Open Amount\",\r\n    \"Current BackOrder Amount\",\r\n    \"Current Backlog Amount\"\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataFinalAggSales.QVD]\r\n(qvd);\r\n\r\nLOAD\r\n    \"Business Family Name\",\r\n    \"Business Family\"\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataFinalBusinessFamily.QVD]\r\n(qvd);\r\n\r\nLOAD\r\n    \"Channel Name\",\r\n    Channel\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataFinalChannel.QVD]\r\n(qvd);\r\n\r\nLOAD\r\n    \"Address Number\",\r\n    \"Customer Address 1\",\r\n    \"Customer Address 2\",\r\n    \"Customer Address 3\",\r\n    \"Customer Address 4\",\r\n    \"Zip Code\",\r\n    City,\r\n    County,\r\n    State,\r\n    Country\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataFinalCustomerAddress.QVD]\r\n(qvd);\r\n\r\nLOAD\r\n    Division,\r\n    \"Business Family\",\r\n    \"Customer Type\",\r\n    Channel,\r\n    \"Category Code 5\",\r\n    \"Zone Mgr\",\r\n    \"Category Code 7\",\r\n    \"Regional Sales Mgr\",\r\n    \"Distribution Channel Mgr\",\r\n    \"Region Code\",\r\n    \"Price Discount Cde 4\",\r\n    \"Line of Business\",\r\n    \"Sales Volume\",\r\n    Customer,\r\n    \"Address Number\",\r\n    \"Customer Number\",\r\n    Consolidated,\r\n    \"Search Type\",\r\n    Phone,\r\n    \"Business Unit\",\r\n    \"SIC Code\",\r\n    \"Tax Certificate\"\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataFinalCustomers.QVD]\r\n(qvd);\r\nLOAD\r\n    \"Customer Type Name\",\r\n    \"Customer Type\"\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataFinalCustomerType.QVD]\r\n(qvd);\r\n\r\n\r\n\r\n\r\n\r\n///$tab Section 3\r\nLOAD\r\n    \"Distribution Channel Mgr Name\",\r\n    \"Distribution Channel Mgr\"\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataFinalDistribution.QVD]\r\n(qvd);\r\n\r\nLOAD\r\n    \"Division Name\",\r\n    Division\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataFinalDivision.QVD]\r\n(qvd);\r\n\r\nLOAD\r\n    \"Family Class Desc\",\r\n    \"Family Class\"\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataFinalFamilyClass.QVD]\r\n(qvd);\r\n\r\nLOAD\r\n    \"Item Branch 3rd Item Number\",\r\n    \"Item Branch G/L Category\",\r\n    \"Short Name\",\r\n    \"Item Branch 2nd Item Number\",\r\n    \"Item-Branch Key\",\r\n    \"Item Branch Reorder Quantity\",\r\n    Horsepower,\r\n    \"Item Branch Category Code 6\",\r\n    \"Item Branch Category Code 7\",\r\n    \"Item Branch Primary Supplier\"\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataFinalItemBranch.QVD]\r\n(qvd);\r\n\r\nLOAD\r\n    \"Item Class Desc\",\r\n    \"Item Class\"\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataFinalItemClass.QVD]\r\n(qvd);\r\n\r\nLOAD\r\n    \"Short Name\",\r\n    \"Item Count\",\r\n    \"Product Price Group\",\r\n    \"Product Department\",\r\n    \"Product Line\",\r\n    \"Product Group\",\r\n    \"Product Type\",\r\n    \"Master Planning Family\",\r\n    \"Product Sub Group\"\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataFinalItemMaster.QVD]\r\n(qvd);\r\n\r\nLOAD\r\n    \"Master Planning Family Desc\",\r\n    \"Master Planning Family\"\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataFinalMasterPlanning.QVD]\r\n(qvd);\r\n\r\n\r\n///$tab Section 4\r\nLOAD\r\n    \"Product Group Desc\",\r\n    \"Product Group\"\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataFinalProductGroup.QVD]\r\n(qvd);\r\n\r\nLOAD\r\n    \"Product Line Desc\",\r\n    \"Product Line\"\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataFinalProductLine.QVD]\r\n(qvd);\r\n\r\nLOAD\r\n    \"Product Sub Group Desc\",\r\n    \"Product Sub Group\"\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataFinalProductSubGroup.QVD]\r\n(qvd);\r\n\r\nLOAD\r\n    \"Product Type Desc\",\r\n    \"Product Type\"\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataFinalProductType.QVD]\r\n(qvd);\r\n\r\nLOAD\r\n    \"Regional Sales Mgr Name\",\r\n    \"Regional Sales Mgr\"\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataFinalRegional.QVD]\r\n(qvd);\r\n\r\nLOAD\r\n    \"Order Number\",\r\n    \"Address Number Header\",\r\n    \"Order Gross Amount\",\r\n    \"Order Type Header\",\r\n    \"Business Unit Order Header\",\r\n    \"Order Date Header\",\r\n    \"Hold Orders Code Header\",\r\n    \"Company Number Header\",\r\n    \"Stop Code Header\",\r\n    \"Zone Code Header\",\r\n    \"Hold Code Header\",\r\n    \"Ship To Address Header\",\r\n    \"Parent Address Number Header\",\r\n    \"Orderby Header\",\r\n    \"Freight Code Header\"\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataFinalSalesHeader.QVD]\r\n(qvd);\r\n\r\nLOAD\r\n    \"Region Name\",\r\n    \"Region Code\"\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataFinalSalesRegion.QVD]\r\n(qvd);\r\n\r\nLOAD\r\n    \"Sales Rep\",\r\n    \"Sales Rep Name\"\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataFinalSalesRep.QVD]\r\n(qvd);\r\n\r\nLOAD\r\n    \"Ship To\",\r\n    \"Ship To Customer Address 1\",\r\n    \"Ship To Customer Address 2\",\r\n    \"Ship To Customer Address 3\",\r\n    \"Ship To Customer Address 4\",\r\n    \"Ship To Zip Code\",\r\n    \"Ship To City\",\r\n    \"Ship To County\",\r\n    \"Ship To State\",\r\n    \"Ship To Country\",\r\n    \"Ship To Zip Code Short\"\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataFinalShipToAddress2.QVD]\r\n(qvd);\r\n\r\nLOAD\r\n    BudKey,\r\n    \"YTD Budget Amount\",\r\n    \"TM Budget Amount\"\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataFinalYTDBudget.QVD]\r\n(qvd);\r\n\r\nLOAD\r\n    \"Zone Mgr Name\",\r\n    \"Zone Mgr\"\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataFinalZone.QVD]\r\n(qvd);\r\n\r\nLOAD\r\n    Fiscal,\r\n    FiscalRank\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataFiscalRank.QVD]\r\n(qvd);\r\n\r\nLOAD\r\n    BasketItem,\r\n    \"Order Number\"\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DatalinkBasket.QVD]\r\n(qvd);\r\n\r\nLOAD\r\n    maptype\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales Datamaptype.QVD]\r\n(qvd);\r\n\r\nLOAD\r\n    \"Order Number\",\r\n    OrderCount\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataOrderCount.QVD]\r\n(qvd);\r\n\r\nLOAD\r\n    \"Order Date 2\",\r\n    OrderYear,\r\n    OrderMonth,\r\n    OrderQuarter,\r\n    \"Order Date Header\"\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataOrderDates1.QVD]\r\n(qvd);\r\n\r\nLOAD\r\n    State,\r\n    state_abbr,\r\n    state_name\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataProvince.QVD]\r\n(qvd);\r\n\r\nLOAD\r\n    NoOfItem,\r\n    MaxNoOfItem,\r\n    DateKey,\r\n    \"Order Number\",\r\n    \"Item-Branch Key\"\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataSales.QVD]\r\n(qvd);\r\n\r\nLOAD\r\n    \"Sales by Customer by YearQuarter\",\r\n    Low,\r\n    High\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataSalesdecile-1.QVD]\r\n(qvd);\r\n\r\nLOAD\r\n    \"Address Number\",\r\n    BudKey,\r\n    AggKey,\r\n    \"Ship To\",\r\n    \"Sales Rep\",\r\n    \"Item Class\",\r\n    CustKey,\r\n    \"Family Class\",\r\n    \"Sales Amount Based on List Price\",\r\n//     \"Line Desc 1\",\r\n    \"Invoice Number\",\r\n    \"Backlog Amount\",\r\n    \"Sales Quantity\",\r\n    \"Qty Backordered\",\r\n    \"Actual Delivery Date\",\r\n    \"Last Status\",\r\n    \"Number Of Days Late\",\r\n    \"Doc Type\",\r\n    \"Order Status Primary\",\r\n    \"Order Status\",\r\n    \"Line Number\",\r\n    \"Item Number\",\r\n    Applymap('Item Map', \"Item Number\") as [Line Desc 1],\r\n    \"Line Type\",\r\n    \"List Price\",\r\n    \"Sales Cost Amount\",\r\n    \"Order Margin\",\r\n    \"Open Order Cost Amount\",\r\n    \"Discount Amount\",\r\n    \"Invoice Date\",\r\n    \"Company Number Detail\",\r\n    \"Payment Terms\",\r\n    \"Sales Unit Cost Price\",\r\n    \"Open Order Quantity\",\r\n    \"Unit Price\",\r\n    \"Business Unit Details\",\r\n    \"Next Status\",\r\n    \"Promised Delivery Date\",\r\n    \"Sales Margin Amount\",\r\n    \"U/M\",\r\n    \"Parent Address Number\",\r\n    \"Open Order Amount\",\r\n    \"Sales Amount\",\r\n    \"BackOrder Amount\",\r\n    \"Sales Price\",\r\n    \"Address Order Number\",\r\n    \"Late Shipment\",\r\n    \"Order Type Detail\",\r\n    Shipments,\r\n    DateKey,\r\n    \"Order Number\",\r\n    \"Item-Branch Key\"\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataSalesDetails.QVD]\r\n(qvd);\r\n\r\nLOAD\r\n    \"Ship To State\",\r\n    \"Ship To X\",\r\n    \"Ship To Y\"\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataShipToMapCoordinates.QVD]\r\n(qvd);\r\n\r\n\r\nLOAD *, GeoMakePoint(latitude, longitude) as QlikPoint;\r\nLOAD\r\n    \"Ship To Zip Code Short\",\r\n    latitude,\r\n    longitude\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Customer Good Sales DataZipData.QVD]\r\n(qvd);\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n///$tab Employee Performance.xlsx\r\nLOAD\r\n    \"Sales Rep Name\",\r\n    \"Sales Rep Performance\"\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Employee Performance.xlsx]\r\n(ooxml, embedded labels, table is Sheet1);\r\n\r\n\r\n\r\n///$tab Inventory.xls\r\nLOAD\r\n    \"Line Desc 1\",\r\n    Inventory,\r\n    \"Lead Time\"\r\nFROM [lib://Customer Good Sales Data2 (ip-0ab2a663_chuck)/Inventory.xls]\r\n(biff, embedded labels, table is Sheet1$);\r\n\r\n\r\n///$tab Section 5\r\n[autoCalendar]: \r\n  DECLARE FIELD DEFINITION Tagged ('$date')\r\nFIELDS\r\n  Dual(Year($1), YearStart($1)) AS [Year] Tagged ('$axis', '$year'),\r\n  Dual('Q'&Num(Ceil(Num(Month($1))/3)),Num(Ceil(NUM(Month($1))/3),00)) AS [Quarter] Tagged \r\n\r\n('$quarter'),\r\n  Dual(Year($1)&'-Q'&Num(Ceil(Num(Month($1))/3)),QuarterStart($1)) AS [YearQuarter] Tagged \r\n\r\n('$axis', '$yearquarter'),\r\n  Month($1) AS [Month] Tagged ('$month'),\r\n  Dual(Year($1)&'-'&Month($1), monthstart($1)) AS [YearMonth] Tagged ('$axis', '$yearmonth'),\r\n  Dual('W'&Num(Week($1),00), Num(Week($1),00)) AS [Week] Tagged ('$weeknumber'),\r\n  Date(Floor($1)) AS [Date] Tagged ('$date');\r\n\r\nDERIVE FIELDS FROM FIELDS \"Month\" USING [autoCalendar] ;\r\n"}}